<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>LICITAR • Painel</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

<style>
/* ======================================================
   RESET & BASE
====================================================== */
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:"Inter", sans-serif;
}

body{
  height:100vh;
  background:#f4f6f9;
  overflow:hidden;
}

/* ======================================================
   CONTAINER
====================================================== */
.app{
  display:flex;
  height:100vh;
  width:100vw;
}

/* ======================================================
   SIDEBAR (AUTO HOVER)
====================================================== */
.sidebar{
  position:fixed;
  left:0;
  top:0;
  height:100vh;
  width:230px;
  background:#ffffff;
  border-right:1px solid #e2e6ef;
  display:flex;
  flex-direction:column;
  transform:translateX(-180px);
  transition:transform .35s ease;
  z-index:20;
}

/* área sensível */
.sidebar-hover-zone{
  position:fixed;
  left:0;
  top:0;
  width:18px;
  height:100vh;
  z-index:30;
}

/* hover revela */
.sidebar-hover-zone:hover + .sidebar,
.sidebar:hover{
  transform:translateX(0);
}

/* ======================================================
   LOGO
====================================================== */
.logo-area{
  padding:18px 0 22px;
  text-align:center;
  border-bottom:1px solid #edf0f6;
}
.logo-area img{
  width:120px;
}

/* ======================================================
   MENU
====================================================== */
.menu{
  padding:14px 8px;
  overflow-y:auto;
}

.menu-item{
  display:flex;
  align-items:center;
  gap:12px;
  padding:11px 16px;
  margin:6px 6px;
  font-size:14px;
  color:#1d2d50;
  border-radius:10px;
  cursor:pointer;
  transition:.2s;
}

.menu-item img{
  width:20px;
}

.menu-item:hover{
  background:#eef3ff;
}

.menu-item.active{
  background:#dce6ff;
  font-weight:600;
  border-left:4px solid #1d57c9;
}

/* ======================================================
   SUBMENU
====================================================== */
.submenu{
  display:none;
  margin:4px 0 8px 46px;
}

.submenu a{
  display:block;
  padding:8px 12px;
  font-size:13px;
  border-radius:8px;
  color:#56627a;
  cursor:pointer;
}

.submenu a:hover{
  background:#eef3ff;
}

.submenu a.active-sub{
  background:#dce6ff;
  font-weight:600;
  color:#1d2d50;
}

/* ======================================================
   MAIN
====================================================== */
.main{
  flex:1;
  margin-left:0;
  display:flex;
  flex-direction:column;
  height:100vh;
  width:100%;
}

/* ======================================================
   HEADER
====================================================== */
.header{
  height:52px;
  background:linear-gradient(90deg,#0b1e39,#102b55);
  color:white;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 24px;
  box-shadow:0 2px 6px rgba(0,0,0,.18);
}

.logo-title{
  font-size:18px;
  font-weight:800;
  letter-spacing:2px;
  animation:fadeIn .8s ease forwards;
}

@keyframes fadeIn{
  from{opacity:0; transform:translateY(-6px);}
  to{opacity:1; transform:translateY(0);}
}

.user-area{
  display:flex;
  align-items:center;
  gap:18px;
  font-size:13px;
}

.logout{
  cursor:pointer;
  font-weight:600;
  color:#ffdede;
}
.logout:hover{
  color:#ffffff;
}

/* ======================================================
   IFRAME
====================================================== */
iframe{
  border:none;
  width:100%;
  height:calc(100vh - 52px);
  background:#f4f6f9;
}

/* ======================================================
   SCROLLBAR
====================================================== */
.menu::-webkit-scrollbar{
  width:6px;
}
.menu::-webkit-scrollbar-thumb{
  background:#cfd6e6;
  border-radius:10px;
}
</style>
</head>

<body>

<div class="app">

  <!-- ZONA DE HOVER -->
  <div class="sidebar-hover-zone"></div>

  <!-- SIDEBAR -->
  <div class="sidebar">

    <div class="logo-area">
      <img src="logo.png">
    </div>

    <div class="menu">

      <div class="menu-item" onclick="openPage('home.html')" data-page="home.html">
        <img src="https://cdn-icons-png.flaticon.com/512/1946/1946488.png">
        <span>Home</span>
      </div>

      <div class="menu-item" onclick="toggleSub('sub_encontrar')">
        <img src="https://cdn-icons-png.flaticon.com/512/149/149852.png">
        <span>Encontrar</span>
      </div>

      <div class="submenu" id="sub_encontrar">
        <a onclick="openPage('buscar.html')" data-page="buscar.html">Buscar Oportunidades</a>
        <a onclick="openPage('avisos.html')" data-page="avisos.html">Meus Avisos</a>
        <a onclick="openPage('banco.html')" data-page="banco.html">Banco de Licitações</a>
      </div>

      <div class="menu-item" onclick="openPage('dashboard.html')" data-page="dashboard.html">
        <img src="https://cdn-icons-png.flaticon.com/512/1828/1828884.png">
        <span>Dashboard</span>
      </div>

      <div class="menu-item" onclick="openPage('anexos.html')" data-page="anexos.html">
        <img src="https://cdn-icons-png.flaticon.com/512/2985/2985150.png">
        <span>Anexos ComprasNet</span>
      </div>

      <div class="menu-item" onclick="toggleSub('sub_cadastrar')">
        <img src="https://cdn-icons-png.flaticon.com/512/992/992651.png">
        <span>Cadastrar</span>
      </div>

      <div class="submenu" id="sub_cadastrar">
        <a onclick="openPage('documentos.html')" data-page="documentos.html">Documentos</a>
        <a onclick="openPage('cadastroempresas.html')" data-page="cadastroempresas.html">Empresas e Fornecedores</a>
        <a onclick="openPage('licitacoes.html')" data-page="licitacoes.html">Licitações</a>
        <a onclick="openPage('usuarios.html')" data-page="usuarios.html">Usuários</a>
      </div>

      <div class="menu-item" onclick="toggleSub('sub_disputar')">
        <img src="https://cdn-icons-png.flaticon.com/512/1828/1828859.png">
        <span>Disputar</span>
      </div>

      <div class="submenu" id="sub_disputar">
        <a onclick="openPage('disputar.html')" data-page="disputar.html">Enviar Lances</a>
      </div>

      <div class="menu-item" onclick="toggleSub('sub_monitorar')">
        <img src="https://cdn-icons-png.flaticon.com/512/1827/1827956.png">
        <span>Cotação</span>
      </div>

      <div class="submenu" id="sub_monitorar">
        <a onclick="openPage('cotacao.html')" data-page="cotacao.html">Gerar Cotação</a>
        <a onclick="openPage('resultadocotacao.html')" data-page="resultadocotacao.html">Gerar Lances</a>
        <a onclick="openPage('fornecedor.html')" data-page="fornecedor.html">Painel do Fornecedor</a>
      </div>

      <div class="menu-item" onclick="toggleSub('sub_dados')">
        <img src="https://cdn-icons-png.flaticon.com/512/1828/1828805.png">
        <span>Visão de Dados</span>
      </div>

      <div class="submenu" id="sub_dados">
        <a onclick="openPage('visao-dados.html')" data-page="visao-dados.html">Análises</a>
      </div>

      <div class="menu-item" onclick="openPage('configuracoes.html')" data-page="configuracoes.html">
        <img src="https://cdn-icons-png.flaticon.com/512/3524/3524659.png">
        <span>Configurações</span>
      </div>

    </div>
  </div>

  <!-- MAIN -->
  <div class="main">
    <div class="header">
      <div class="logo-title">LICITAR</div>
      <div class="user-area">
        <span id="userMail"></span>
        <span class="logout" onclick="logout()">Sair</span>
      </div>
    </div>

    <iframe id="frame" src="home.html"></iframe>
  </div>

</div>

<!-- SCRIPT -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const supabaseClient = supabase.createClient(
  "https://mblvyircwsaxaslklzky.supabase.co",
  "sb_publishable_oN2CuBzXHaUF7NHYS_M7aw_tBqVeD-x"
);

async function validarSessao(){
  const email = localStorage.getItem("usuarioEmail");
  if(!email){
    window.location.href="login.html";
    return;
  }

  const { data, error } = await supabaseClient
    .from("usuarios")
    .select("id")
    .eq("email", email)
    .single();

  if(error || !data){
    localStorage.removeItem("usuarioEmail");
    alert("Sessão expirada.");
    window.location.href="login.html";
    return;
  }

  document.getElementById("userMail").innerText = email;
}

validarSessao();
setInterval(validarSessao, 15000);

/* navegação */
function openPage(page){
  document.getElementById("frame").src = page;
  highlightMenu(page);
}

function highlightMenu(page){
  document.querySelectorAll(".menu-item").forEach(i=>i.classList.remove("active"));
  document.querySelectorAll(".submenu a").forEach(i=>i.classList.remove("active-sub"));

  const sub = document.querySelector(`a[data-page="${page}"]`);
  if(sub){
    sub.classList.add("active-sub");
    sub.closest(".submenu").previousElementSibling.classList.add("active");
    sub.closest(".submenu").style.display="block";
  }
}

function toggleSub(id){
  const el = document.getElementById(id);
  el.style.display = el.style.display === "block" ? "none" : "block";
}

function logout(){
  localStorage.removeItem("usuarioEmail");
  window.location.href="login.html";
}
</script>

</body>
</html>
