<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>LICITAR ‚Ä¢ Painel</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
/* ====================================================== */
/* RESET & BASE */
/* ====================================================== */
*{
  margin:0; padding:0;
  box-sizing:border-box;
  font-family:"Inter", sans-serif;
}

body{
  height:100vh;
  background:#f4f6f9;
  display:flex;
  overflow:hidden;
}

/* ====================================================== */
/* SIDEBAR */
/* ====================================================== */
.sidebar{
  width:210px;
  background:#fff;
  border-right:1px solid #e2e6ef;
  display:flex;
  flex-direction:column;
  padding-top:18px;
  transition:width .25s;
  position:relative;
}
.sidebar.closed{ width:70px; }

.logo-area{
  text-align:center;
  padding-bottom:20px;
}
.logo-area img{
  width:110px;
  transition:.25s;
}
.sidebar.closed .logo-area img{ width:40px; }

#toggleMenu{
  position:absolute;
  left:200px;
  top:15px;
  width:32px;
  height:32px;
  border-radius:50%;
  background:#1d57c9;
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  box-shadow:0 4px 10px rgba(0,0,0,.25);
}
.sidebar.closed #toggleMenu{ left:55px; }

.menu{ margin-top:10px; }

.menu-item{
  display:flex;
  align-items:center;
  gap:10px;
  padding:10px 18px;
  margin:4px 8px;
  font-size:14px;
  color:#1d2d50;
  border-radius:8px;
  cursor:pointer;
}
.menu-item img{ width:20px; }

.menu-item:hover{ background:#eef3ff; }

.menu-item.active{
  background:#dce6ff;
  font-weight:600;
  border-left:4px solid #1d57c9;
}

.sidebar.closed .label{ display:none; }

/* SUBMENU */
.submenu{
  display:none;
  margin-left:45px;
}
.submenu a{
  display:flex;
  padding:8px 12px;
  font-size:13px;
  border-radius:6px;
  color:#56627a;
  cursor:pointer;
}
.submenu a:hover{ background:#eef3ff; }
.submenu a.active-sub{
  background:#dce6ff;
  font-weight:600;
}
.sidebar.closed .submenu{ margin-left:20px; }
.sidebar.closed .submenu .label{ display:none; }

/* ====================================================== */
/* HEADER */
/* ====================================================== */
.header{
  height:48px;
  background:#0b1e39;
  color:white;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 22px;
  box-shadow:0 2px 5px rgba(0,0,0,.12);
}

/* üî• ANIMA√á√ÉO LICITAR */
.logo-title{
  font-size:18px;
  font-weight:800;
  letter-spacing:2px;
  opacity:0;
  animation:logoIn .9s ease-out forwards;
}
@keyframes logoIn{
  from{ opacity:0; transform:translateY(-10px); }
  to{ opacity:1; transform:translateY(0); }
}

.user-area{
  display:flex;
  align-items:center;
  gap:18px;
}
.logout{
  cursor:pointer;
  font-weight:600;
  color:#ffdddd;
}
.logout:hover{ color:#fff; }

/* ====================================================== */
/* MAIN / IFRAME */
/* ====================================================== */
.main{
  flex:1;
  display:flex;
  flex-direction:column;
  height:100vh;
}
iframe{
  border:none;
  width:100%;
  height:calc(100vh - 48px);
}
</style>
</head>

<body>

<!-- SIDEBAR -->
<div class="sidebar" id="sidebar">
  <div id="toggleMenu" onclick="toggleMenu()">‚ùÆ</div>

  <div class="logo-area">
    <img src="logo.png">
  </div>

<div class="menu">

  <!-- HOME -->
  <div class="menu-item" onclick="openPage('home.html')" data-page="home.html">
    <img src="https://cdn-icons-png.flaticon.com/512/1946/1946488.png">
    <span class="label">Home</span>
  </div>

  <!-- ENCONTRAR -->
  <div class="menu-item" onclick="toggleSub('sub_encontrar')">
    <img src="https://cdn-icons-png.flaticon.com/512/149/149852.png">
    <span class="label">Encontrar</span>
  </div>
  <div class="submenu" id="sub_encontrar">
    <a onclick="openPage('buscar.html')" data-page="buscar.html"><span class="label">Buscar Oportunidades</span></a>
    <a onclick="openPage('avisos.html')" data-page="avisos.html"><span class="label">Meus Avisos</span></a>
    <a onclick="openPage('banco.html')" data-page="banco.html"><span class="label">Banco de Licita√ß√µes</span></a>
  </div>

  <!-- DASHBOARD -->
  <div class="menu-item" onclick="openPage('dashboard.html')" data-page="dashboard.html">
    <img src="https://cdn-icons-png.flaticon.com/512/1828/1828884.png">
    <span class="label">Dashboard</span>
  </div>

  <!-- GEST√ÉO DE LICITA√á√ïES -->
  <div class="menu-item" onclick="toggleSub('sub_licitacoes')">
    <img src="https://cdn-icons-png.flaticon.com/512/942/942748.png">
    <span class="label">Gest√£o de Licita√ß√µes</span>
  </div>
  <div class="submenu" id="sub_licitacoes">
    <a onclick="openPage('licitacoes.html')" data-page="licitacoes.html"><span class="label">Listar Licita√ß√µes</span></a>
    <a onclick="openPage('licitacao-nova.html')" data-page="licitacao-nova.html"><span class="label">Nova Licita√ß√£o</span></a>
    <a onclick="openPage('itens-licitacao.html')" data-page="itens-licitacao.html"><span class="label">Itens da Licita√ß√£o</span></a>
    <a onclick="openPage('mapa-precos.html')" data-page="mapa-precos.html"><span class="label">Mapa de Pre√ßos</span></a>
    <a onclick="openPage('anexos.html')" data-page="anexos.html"><span class="label">Anexos ComprasNet</span></a>
  </div>

  <!-- CADASTROS -->
  <div class="menu-item" onclick="toggleSub('sub_cadastros')">
    <img src="https://cdn-icons-png.flaticon.com/512/992/992651.png">
    <span class="label">Cadastros</span>
  </div>
  <div class="submenu" id="sub_cadastros">
    <a onclick="openPage('empresas.html')" data-page="empresas.html"><span class="label">Empresas</span></a>
    <a onclick="openPage('fornecedores.html')" data-page="fornecedores.html"><span class="label">Fornecedores</span></a>
    <a onclick="openPage('produtos.html')" data-page="produtos.html"><span class="label">Produtos</span></a>
    <a onclick="openPage('documentos.html')" data-page="documentos.html"><span class="label">Documentos</span></a>
    <a onclick="openPage('usuarios.html')" data-page="usuarios.html"><span class="label">Usu√°rios</span></a>
  </div>

  <!-- FINANCEIRO -->
  <div class="menu-item" onclick="toggleSub('sub_financeiro')">
    <img src="https://cdn-icons-png.flaticon.com/512/2331/2331941.png">
    <span class="label">Financeiro</span>
  </div>
  <div class="submenu" id="sub_financeiro">
    <a onclick="openPage('faturamento.html')" data-page="faturamento.html"><span class="label">Faturamento</span></a>
    <a onclick="openPage('pagamentos.html')" data-page="pagamentos.html"><span class="label">Pagamentos</span></a>
    <a onclick="openPage('custos.html')" data-page="custos.html"><span class="label">Custos</span></a>
    <a onclick="openPage('comissoes.html')" data-page="comissoes.html"><span class="label">Comiss√µes</span></a>
  </div>

  <!-- RELAT√ìRIOS -->
  <div class="menu-item" onclick="toggleSub('sub_relatorios')">
    <img src="https://cdn-icons-png.flaticon.com/512/1828/1828919.png">
    <span class="label">Relat√≥rios</span>
  </div>
  <div class="submenu" id="sub_relatorios">
    <a onclick="openPage('relatorio-geral.html')" data-page="relatorio-geral.html"><span class="label">Relat√≥rio Geral</span></a>
    <a onclick="openPage('relatorio-licitacoes.html')" data-page="relatorio-licitacoes.html"><span class="label">Licita√ß√µes</span></a>
    <a onclick="openPage('relatorio-financeiro.html')" data-page="relatorio-financeiro.html"><span class="label">Financeiro</span></a>
  </div>

  <!-- SISTEMA -->
  <div class="menu-item" onclick="toggleSub('sub_sistema')">
    <img src="https://cdn-icons-png.flaticon.com/512/2099/2099058.png">
    <span class="label">Sistema</span>
  </div>
  <div class="submenu" id="sub_sistema">
    <a onclick="openPage('configuracoes.html')" data-page="configuracoes.html"><span class="label">Configura√ß√µes</span></a>
    <a onclick="openPage('perfis.html')" data-page="perfis.html"><span class="label">Perfis & Permiss√µes</span></a>
    <a onclick="openPage('logs.html')" data-page="logs.html"><span class="label">Logs de Acesso</span></a>
  </div>

</div>
</div>

<!-- MAIN -->
<div class="main">

  <div class="header">
    <div class="logo-title">LICITAR</div>
    <div class="user-area">
      <span id="userMail"></span>
      <span class="logout" onclick="logout()">Sair</span>
    </div>
  </div>

  <!-- üî• HOME ABRE AUTOMATICAMENTE -->
  <iframe id="frame" src="home.html"></iframe>

</div>

<!-- SCRIPT -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const supabaseClient = supabase.createClient(
  "https://mblvyircwsaxaslklzky.supabase.co",
  "sb_publishable_oN2CuBzXHaUF7NHYS_M7aw_tBqVeD-x"
);

async function validarSessao(){
  const email = localStorage.getItem("usuarioEmail");
  if(!email){
    window.location.href="login.html";
    return;
  }

  const { data, error } = await supabaseClient
    .from("usuarios")
    .select("id")
    .eq("email", email)
    .single();

  if(error || !data){
    localStorage.removeItem("usuarioEmail");
    alert("Seu acesso foi encerrado.");
    window.location.href="login.html";
    return;
  }

  document.getElementById("userMail").innerText = email;
}

validarSessao();
setInterval(validarSessao, 15000);

/* navega√ß√£o */
function openPage(page){
  document.getElementById("frame").src = page;
  highlightMenu(page);
}

function highlightMenu(page){
  document.querySelectorAll(".menu-item").forEach(i=>i.classList.remove("active"));
  document.querySelectorAll(".submenu a").forEach(i=>i.classList.remove("active-sub"));
  let sub=document.querySelector(`a[data-page="${page}"]`);
  if(sub){
    sub.classList.add("active-sub");
    sub.closest(".submenu").previousElementSibling.classList.add("active");
  }
}

function toggleSub(id){
  let el=document.getElementById(id);
  el.style.display=el.style.display==="block"?"none":"block";
}

function toggleMenu(){
  document.getElementById("sidebar").classList.toggle("closed");
}

function logout(){
  localStorage.removeItem("usuarioEmail");
  window.location.href="login.html";
}
</script>

</body>
</html>
